Suga4U Room ‚Äî Full Plan for Developer
1) Objective

Suga4U is a premium ‚Äúsugar‚Äù experience room designed to monetize:

Entry fee (except VIP)

Time metering (pay-to-stay)

Micro-unlocks (Secrets, Favorites link reveals)

Limited-time, limited-slot offers (Offer Drops)

Paid request tickets (Request Menu)

Tips/gifts + ‚ÄúBuy-for-her‚Äù (treated as tip equal to item price)

Important: This room should not educate users about badge rules or badge tier pricing. Those belong in Signup and My Profile.

2) Access + Eligibility

Eligibility gating happens before the room:

The app should restrict room entry to users with the appropriate Suga badge (Suga Daddy/Mama tiers).

In the room UI, we only show the user‚Äôs tier badge state.

3) Entry Rules (Locked)

Rule:

$10 Entry for all fans unless VIP

VIP enters free

Entry is charged once per room session (i.e., per join)

UX:

If non-VIP and entry not paid: show banner at top:

‚ÄúEnter Suga4U‚Äù + ‚ÄúEnter $10‚Äù button

VIP should never see this banner (auto-enter).

Backend:

On click ‚ÄúEnter $10‚Äù:

Create transaction: ENTRY_FEE

Confirm wallet/card payment

Mark session: hasPaidEntry = true

Store this server-side for the current session, not only client.

4) Pay-to-Stay Rules (Locked)

Rule:

First 10 minutes free

After free window, $2 per minute

Time is purchased in 1-minute blocks

UX Requirements:

Header shows time pill:

While free: Free MM:SS

After free: Time MM:SS (remaining paid time)

When paid time runs out after the free window:

Show right-side card: ‚ÄúTime Expired‚Äù + ‚ÄúPay to Stay +1 min‚Äù

Backend Requirements:

Timer must be server authoritative to prevent client tampering.

Session should track:

joined_at

free_seconds_remaining

paid_seconds_purchased

paid_seconds_remaining

When user buys +1 min:

Create transaction: PAY_TO_STAY amount = $2

Increment remaining paid seconds by 60

Enforcement Policy (developer chooses):

Soft-lock interactions when time expires (disable chat/tip/unlocks), OR

Hard-remove user from room when time expires

UI should still allow the purchase action.

5) In-Room Monetization Components (Must Match UI)
(1) Creator Secrets (Blurred Unlocks)

Behavior:

List of secret items

Title visible, content blurred until unlocked

Each secret has an unlock price (example data in mock)

Unlock reveals content instantly

Backend:

Transaction: SECRET_UNLOCK

Persist entitlement: fan_id + creator_id + secret_id

Once unlocked, remain unlocked across sessions.

(4) Pinned Offer Drops (Timed + Limited Slots)

Behavior:

Display offer cards with:

Countdown timer

Slots remaining

Unlock button price

Purchase reduces slot count by 1

Offer stops when timer hits 0 OR slots = 0

Backend:

Offer inventory must be transactional/atomic to prevent oversells

Transaction: OFFER_CLAIM

Persist receipt: fan_id + offer_id

(6) Paid Request Menu (Tickets)

Behavior:

Fan enters a text note (required)

Fan selects a fixed-price request button:

Pose, Shoutout, Quick Tease, Custom Clip (examples)

Creates a paid request record for the creator to fulfill later

Backend:

Transaction: PAID_REQUEST

Create request record:

request_type

note

status (pending/accepted/fulfilled/refunded optional)

Creator sees these in a queue (Creator Dashboard).

(7) Creator Favorites Expansion (Reveal Links + Buy-for-Her)

Behavior:

Favorites tiers (example: cute/luxury/dream)

Fan pays to unlock a tier

Each item inside has:

Pay-to-reveal link (micro fee)

After reveal: show clickable URL

‚ÄúBuy‚Äù button: charges full item price

IMPORTANT: this is NOT a real purchase

It sends funds to creator as a tip

Fan perceives they purchased it, creator buys later

Backend:

Transaction: FAVORITES_TIER_UNLOCK (optional, if you want unlock persisted)

Transaction: LINK_REVEAL (persist per item)

Transaction: BUY_FOR_HER:

treat as TIP with metadata:

item_name, item_price, is_buy_for_her=true

Optional: apply ‚ÄúSuga fee‚Äù logic later if you want (not enforced in this room UI right now).

(8) Tips / Gifts (Core)

Behavior:

Gift buttons with fixed amounts

Triggers chat + reactions

Updates ‚ÄúSuga Goal‚Äù progress bar

Backend:

Transaction: TIP

Same payout split rules as the platform (your global rules).

6) Layout Requirements (Matches Mockup)

3-column structure inside main grid:

Left (2 columns wide):

Creator Spotlight (video placeholder + goal bar)

Pinned Offer Drops

Creator Secrets

Creator Favorites

Middle:

Live Chat

Right:

Time Expired pay-to-stay (only when needed)

Request Menu

Send Suga gifts

Quick paid actions (Say My Name, Sponsor Room, Voice, Photo, Private 1-on-1)

7) What Must NOT Be Displayed in Room

‚ÄúSuga4U Entry Rule‚Äù education content

Badge pricing/tier subscription pricing

How to buy badges

Those live in:

Signup flow

My Profile dropdown ‚Üí badge management

8) Recommended Data Structures (Minimum)

Room Session

room_id

fan_id

creator_id

tier (Bronze/Silver/Gold/Platinum/VIP)

has_paid_entry

joined_at

free_seconds_remaining

paid_seconds_remaining

Entitlements

secret_unlocks (fan+creator+secret)

favorites_tier_unlocks (fan+creator+tier) (optional)

link_reveals (fan+creator+item)

Transactions

entry_fee	100% platform

pay_to_stay	100% platform

tips/gifts	80/20

secret_unlock	80/20

offer_claim	90/10

paid_request	90/10

link_reveal	80/20

buy_for_her	100% Creator


Current React Code for Mockup (Full)
import React, { useEffect, useMemo, useRef, useState } from "react";
import {
  Crown,
  MessageCircle,
  Heart,
  Star,
  Lock,
  Mic,
  Image as ImageIcon,
  Timer,
  Sparkles,
  Flame,
  Gift,
} from "lucide-react";

/**
 * PlayGroundX ‚Äî Suga4U Room (PREVIEW MOCKUP)
 * ----------------------------------------
 * UX rules (locked):
 * - Do NOT show entry-rule education or badge-tier pricing in this room.
 *   Those belong in signup + My Profile.
 * - In-room: show ONLY status badges + spending surfaces.
 * - Suga Baby label is ALWAYS "Suga Baby"; badge color depends on creator gender (male=blue, female=pink).
 * - Fan badge is the Suga Daddy / Suga Mama tier badge (Bronze/Silver/Gold/Platinum/VIP) with a tier-logo.
 *
 * Monetization rules (locked):
 * - Entry: $10 entry fee unless VIP tier (VIP enters free).
 * - Time: first 10 mins free, then $2 per minute pay-to-stay.
 *
 * Included features in this room:
 * (1) Creator Secrets (blurred unlocks)
 * (4) Pinned Offer Drops (timed + limited slots)
 * (6) Paid Request Menu
 * (7) Favorites expansion: pay to reveal links + Buy sends funds as tip
 * (8) Pay-to-stay session timer + pay action
 */

// ---- Config (Suga4U monetization rules) ------------------------------------
const ENTRY_FEE = 10;
const PAY_TO_STAY_FREE_SECONDS = 10 * 60;
const PAY_TO_STAY_RATE_PER_MIN = 2;

const GIFTS = [
  { label: "üíñ Kiss", amount: 5 },
  { label: "üî• Tease", amount: 10 },
  { label: "üíé Luxury", amount: 25 },
  { label: "üëë Royal", amount: 50 },
] as const;

type FavTier = "cute" | "luxury" | "dream";

type BadgeTier = "Bronze" | "Silver" | "Gold" | "Platinum" | "VIP";

type CreatorGender = "male" | "female";

type Secret = {
  id: string;
  title: string;
  price: number;
  reveal: string;
};

type OfferDrop = {
  id: string;
  title: string;
  description: string;
  price: number;
  totalSlots: number;
  endsInSeconds: number;
};

type PaidRequest = {
  id: string;
  label: string;
  price: number;
  hint: string;
};

type FavoriteItem = {
  name: string;
  price: number;
  linkLabel: string;
  linkUrl: string;
  revealFee: number;
};

const FAVORITES: Record<FavTier, { unlock: number; items: FavoriteItem[] }> = {
  cute: {
    unlock: 10,
    items: [
      {
        name: "Cute Top",
        price: 40,
        linkLabel: "Store link",
        linkUrl: "https://example.com/cute-top",
        revealFee: 3,
      },
      {
        name: "Gloss Set",
        price: 25,
        linkLabel: "Store link",
        linkUrl: "https://example.com/gloss-set",
        revealFee: 2,
      },
    ],
  },
  luxury: {
    unlock: 20,
    items: [
      {
        name: "Luxury Perfume",
        price: 180,
        linkLabel: "Store link",
        linkUrl: "https://example.com/perfume",
        revealFee: 5,
      },
      {
        name: "Silk Lingerie",
        price: 120,
        linkLabel: "Store link",
        linkUrl: "https://example.com/silk",
        revealFee: 5,
      },
    ],
  },
  dream: {
    unlock: 30,
    items: [
      {
        name: "Designer Heels",
        price: 350,
        linkLabel: "Store link",
        linkUrl: "https://example.com/heels",
        revealFee: 8,
      },
      {
        name: "Weekend Getaway",
        price: 500,
        linkLabel: "Offer details",
        linkUrl: "https://example.com/getaway",
        revealFee: 10,
      },
    ],
  },
};

const CREATOR_SECRETS: Secret[] = [
  {
    id: "s1",
    title: "My real type‚Ä¶",
    price: 8,
    reveal: "I love confident talk + kindness.",
  },
  {
    id: "s2",
    title: "What I wear to bed",
    price: 12,
    reveal: "Silk set + perfume. Sometimes nothing.",
  },
  {
    id: "s3",
    title: "My wildest fantasy",
    price: 20,
    reveal: "A private night where you lead.",
  },
  {
    id: "s4",
    title: "My private photo drop",
    price: 25,
    reveal: "(Unlocked in DMs)",
  },
];

const OFFER_DROPS: OfferDrop[] = [
  {
    id: "o1",
    title: "Limited Voice Note Drop",
    description: "First 10 buyers get a personalized 30s voice note.",
    price: 15,
    totalSlots: 10,
    endsInSeconds: 12 * 60,
  },
  {
    id: "o2",
    title: "Outfit Pick (Tonight)",
    description: "Vote by paying ‚Äî top outfit wins (private reveal).",
    price: 10,
    totalSlots: 25,
    endsInSeconds: 8 * 60,
  },
];

const PAID_REQUESTS: PaidRequest[] = [
  { id: "r1", label: "Pose Request", price: 10, hint: "Ask for a pose / angle" },
  { id: "r2", label: "Name Shoutout", price: 15, hint: "She says your name on cam" },
  { id: "r3", label: "Quick Tease", price: 25, hint: "Short premium tease" },
  { id: "r4", label: "Custom Clip", price: 50, hint: "Custom 30‚Äì60s clip" },
];

function clamp(n: number, min: number, max: number) {
  return Math.max(min, Math.min(max, n));
}

function isEntryRequired(tier: BadgeTier) {
  return tier !== "VIP";
}

function fanTierClasses(tier: BadgeTier) {
  switch (tier) {
    case "Bronze":
      return "border-yellow-700/70 text-yellow-500";
    case "Silver":
      return "border-gray-400/70 text-gray-200";
    case "Gold":
      return "border-yellow-400/70 text-yellow-300";
    case "Platinum":
      return "border-indigo-300/70 text-indigo-200";
    case "VIP":
      return "border-yellow-400/80 text-yellow-300";
    default:
      return "border-gray-600 text-gray-200";
  }
}

function fanTierBg(tier: BadgeTier) {
  switch (tier) {
    case "Bronze":
      return "bg-yellow-900/15";
    case "Silver":
      return "bg-gray-500/10";
    case "Gold":
      return "bg-yellow-500/10";
    case "Platinum":
      return "bg-indigo-500/10";
    case "VIP":
      return "bg-yellow-500/15";
    default:
      return "bg-white/5";
  }
}

function creatorBabyClasses(gender: CreatorGender) {
  return gender === "male"
    ? "border-blue-400/70 text-blue-300"
    : "border-pink-400/70 text-pink-300";
}

function SugaTierLogo({ tier, className = "" }: { tier: BadgeTier; className?: string }) {
  // Placeholder tier-logo for Suga Daddy / Suga Mama.
  // Replace this SVG with the final logo asset while keeping tier tinting.
  return (
    <span
      className={`inline-flex items-center justify-center w-5 h-5 rounded-md border ${fanTierClasses(
        tier
      )} ${fanTierBg(tier)} ${className}`}
      aria-label={`Suga tier logo ${tier}`}
      title={`${tier} tier badge logo`}
    >
      <svg
        width="12"
        height="12"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        className="opacity-90"
      >
        <path
          d="M12 2l2.2 4.6L19 7.7l-3.6 3.5.9 5L12 14.9 7.7 16.2l.9-5L5 7.7l4.8-1.1L12 2z"
          stroke="currentColor"
          strokeWidth="1.6"
          strokeLinejoin="round"
        />
        <path
          d="M7.5 20.5h9"
          stroke="currentColor"
          strokeWidth="1.6"
          strokeLinecap="round"
        />
      </svg>
    </span>
  );
}

function formatMMSS(totalSeconds: number) {
  const s = Math.max(0, Math.floor(totalSeconds));
  const mm = String(Math.floor(s / 60)).padStart(2, "0");
  const ss = String(s % 60).padStart(2, "0");
  return `${mm}:${ss}`;
}

// Minimal dev-time sanity checks (no UI impact)
function useDevSanityTests() {
  useEffect(() => {
    console.assert(clamp(0, 0, 10) === 0, "clamp lower bound failed");
    console.assert(clamp(99, 0, 10) === 10, "clamp upper bound failed");
    console.assert(clamp(3, 0, 10) === 3, "clamp passthrough failed");

    console.assert(formatMMSS(0) === "00:00", "formatMMSS(0) failed");
    console.assert(formatMMSS(61) === "01:01", "formatMMSS(61) failed");

    console.assert(isEntryRequired("VIP") === false, "VIP should not require entry");
    console.assert(isEntryRequired("Gold") === true, "Non-VIP should require entry");

    const fanVipLabel = `VIP${"VIP" === "VIP" ? " VIP" : ""}`;
    console.assert(fanVipLabel === "VIP VIP", "VIP label test failed");

    console.assert(fanTierClasses("Gold").length > 0, "fanTierClasses(Gold) empty");
    console.assert(fanTierBg("Gold").length > 0, "fanTierBg(Gold) empty");
  }, []);
}

export default function Suga4URoom() {
  useDevSanityTests();

  // In production, these come from creator profile + fan subscription state.
  const [creatorGender] = useState<CreatorGender>("female");
  const [selectedBadgeTier] = useState<BadgeTier>("Gold");

  // Entry + time
  const [hasPaidEntry, setHasPaidEntry] = useState<boolean>(false);
  const [secondsInRoom, setSecondsInRoom] = useState(0);
  const [paidMinutes, setPaidMinutes] = useState(0);
  const timerRef = useRef<number | null>(null);

  // Chat + reactions
  const [chat, setChat] = useState<string[]>(["Welcome to Suga4U üíñ"]);
  const [chatInput, setChatInput] = useState("");
  const [reaction, setReaction] = useState<string | null>(null);

  // Earnings (aggregate for preview)
  const [totalSuga, setTotalSuga] = useState(0);

  // Secrets
  const [revealedSecrets, setRevealedSecrets] = useState<Record<string, boolean>>({});

  // Offer drops
  const [dropEnds, setDropEnds] = useState<Record<string, number>>(() => {
    const init: Record<string, number> = {};
    OFFER_DROPS.forEach((d) => (init[d.id] = d.endsInSeconds));
    return init;
  });
  const [dropSlots, setDropSlots] = useState<Record<string, number>>(() => {
    const init: Record<string, number> = {};
    OFFER_DROPS.forEach((d) => (init[d.id] = d.totalSlots));
    return init;
  });

  // Favorites unlock + reveal
  const [unlocked, setUnlocked] = useState<Record<FavTier, boolean>>({
    cute: false,
    luxury: false,
    dream: false,
  });
  const [activeTier, setActiveTier] = useState<FavTier | null>(null);
  const [revealedLinks, setRevealedLinks] = useState<Record<string, boolean>>({});

  // Requests
  const [requestText, setRequestText] = useState("");

  // VIP skips entry fee
  useEffect(() => {
    if (selectedBadgeTier === "VIP") setHasPaidEntry(true);
  }, [selectedBadgeTier]);

  const goalPct = useMemo(() => Math.min((totalSuga / 100) * 100, 100), [totalSuga]);
  const fanBadgeLabel = `${selectedBadgeTier}${selectedBadgeTier === "VIP" ? " VIP" : ""}`;

  // Derived pay-to-stay state
  const freeRemaining = Math.max(0, PAY_TO_STAY_FREE_SECONDS - secondsInRoom);
  const inPaidZone = secondsInRoom >= PAY_TO_STAY_FREE_SECONDS;
  const paidSecondsRemaining =
    paidMinutes * 60 - Math.max(0, secondsInRoom - PAY_TO_STAY_FREE_SECONDS);
  const payToStayNeeded = hasPaidEntry && inPaidZone && paidSecondsRemaining <= 0;

  function pushChat(msg: string) {
    setChat((c) => [...c, msg]);
  }

  function addToSuga(amount: number, context: string) {
    setTotalSuga((s) => s + amount);
    pushChat(`${context} ($${amount})`);
  }

  function payEntryFee() {
    if (hasPaidEntry) return;
    setHasPaidEntry(true);
    addToSuga(ENTRY_FEE, "üö™ Room entry");
  }

  function sendGift(label: string, amount: number) {
    setReaction(label);
    addToSuga(amount, `üéÅ ${label} sent`);
    setTimeout(() => setReaction(null), 1200);
  }

  function sendMessage() {
    const t = chatInput.trim();
    if (!t) return;
    pushChat(t);
    setChatInput("");
  }

  function unlockFavoritesTier(t: FavTier) {
    setUnlocked((u) => ({ ...u, [t]: true }));
    setActiveTier(t);
    addToSuga(FAVORITES[t].unlock, `üîì Unlocked ${t} favorites`);
  }

  function revealFavoriteLink(tier: FavTier, itemName: string, fee: number) {
    const key = `${tier}:${itemName}`;
    if (revealedLinks[key]) return;
    setRevealedLinks((m) => ({ ...m, [key]: true }));
    addToSuga(fee, `üîç Revealed link for ${itemName}`);
  }

  function buyForHer(price: number, name: string) {
    addToSuga(price, `üõçÔ∏è Buy-for-her: ${name}`);
  }

  function revealSecret(secret: Secret) {
    if (revealedSecrets[secret.id]) return;
    setRevealedSecrets((m) => ({ ...m, [secret.id]: true }));
    addToSuga(secret.price, `üîì Secret unlocked: ${secret.title}`);
  }

  function claimDrop(d: OfferDrop) {
    const slots = dropSlots[d.id] ?? 0;
    const ends = dropEnds[d.id] ?? 0;
    if (slots <= 0 || ends <= 0) return;
    setDropSlots((m) => ({ ...m, [d.id]: Math.max(0, (m[d.id] ?? 0) - 1) }));
    addToSuga(d.price, `‚ú® Claimed: ${d.title}`);
  }

  function submitRequest(r: PaidRequest) {
    const t = requestText.trim();
    if (!t) {
      pushChat("‚ö†Ô∏è Add a request note first.");
      return;
    }
    addToSuga(r.price, `üì© Request sent: ${r.label}`);
    pushChat(`üìù Note: ${t}`);
    setRequestText("");
  }

  function payToStayOneMinute() {
    setPaidMinutes((m) => m + 1);
    addToSuga(PAY_TO_STAY_RATE_PER_MIN, "‚è±Ô∏è Pay-to-stay +1 min");
  }

  // Timers
  useEffect(() => {
    if (timerRef.current) window.clearInterval(timerRef.current);
    timerRef.current = window.setInterval(() => {
      setSecondsInRoom((s) => s + 1);
    }, 1000);

    return () => {
      if (timerRef.current) window.clearInterval(timerRef.current);
    };
  }, []);

  useEffect(() => {
    const id = window.setInterval(() => {
      setDropEnds((m) => {
        const next: Record<string, number> = { ...m };
        Object.keys(next).forEach((k) => {
          next[k] = Math.max(0, next[k] - 1);
        });
        return next;
      });
    }, 1000);

    return () => window.clearInterval(id);
  }, []);

  return (
    <div className="min-h-screen bg-black text-white">
      {/* Header */}
      <div className="flex items-center justify-between px-6 py-4 border-b border-pink-500/20">
        <div className="flex items-center gap-2">
          <span className="text-pink-500 text-2xl font-semibold">PlayGround</span>
          <span className="text-blue-400 text-2xl font-extrabold">X</span>
        </div>

        <div className="text-pink-300 text-sm flex items-center gap-2">
          <Crown className="w-4 h-4" /> Suga4U Room

          {/* Creator badge */}
          <span
            className={`ml-2 px-2 py-[2px] rounded-full text-[10px] border ${creatorBabyClasses(
              creatorGender
            )}`}
            title="Creator badge"
          >
            Suga Baby
          </span>

          {/* Fan tier badge */}
          <span
            className={`px-2 py-[2px] rounded-full text-[10px] border inline-flex items-center gap-1 ${fanTierClasses(
              selectedBadgeTier
            )} ${fanTierBg(selectedBadgeTier)}`}
            title="Fan Suga Daddy / Suga Mama tier badge"
          >
            <SugaTierLogo tier={selectedBadgeTier} />
            {fanBadgeLabel}
          </span>

          {/* Pay-to-stay status (no pricing shown) */}
          <span className="ml-2 px-2 py-[2px] rounded-full text-[10px] border border-pink-500/30 text-pink-200 inline-flex items-center gap-1">
            <Timer className="w-3 h-3" />
            {freeRemaining > 0
              ? `Free ${formatMMSS(freeRemaining)}`
              : `Time ${formatMMSS(Math.max(0, paidSecondsRemaining))}`}
          </span>
        </div>
      </div>

      <main className="p-8 grid grid-cols-1 md:grid-cols-4 gap-6 max-w-7xl mx-auto">
        {/* Entry CTA (non-VIP only, no education) */}
        {!hasPaidEntry && isEntryRequired(selectedBadgeTier) && (
          <div className="md:col-span-4 mb-4 rounded-2xl border border-pink-500/40 bg-black/60 p-4 flex items-center justify-between">
            <div className="text-pink-200 text-sm">Enter Suga4U</div>
            <button
              onClick={payEntryFee}
              className="bg-pink-600 px-4 py-2 rounded-xl hover:bg-pink-700 text-sm"
            >
              Enter $10
            </button>
          </div>
        )}

        {/* LEFT: Creator Spotlight */}
        <div className="md:col-span-2 flex flex-col gap-4">
          <div className="relative aspect-video rounded-3xl border border-pink-500/40 bg-black flex items-center justify-center overflow-hidden">
            <div className="pointer-events-none absolute inset-0 opacity-20 animate-pulse bg-gradient-to-b from-pink-500/30 via-transparent to-blue-500/20" />

            {reaction && <div className="absolute text-4xl text-pink-400 animate-pulse">{reaction}</div>}
            <span className="text-pink-300">Creator Spotlight</span>

            <div className="absolute bottom-3 left-3 right-3">
              <div className="h-2 bg-gray-800 rounded-full overflow-hidden">
                <div className="h-full bg-pink-500" style={{ width: `${goalPct}%` }} />
              </div>
              <div className="text-xs text-pink-300 mt-1">Suga Goal: ${totalSuga} / $100</div>
            </div>
          </div>

          {/* Offer Drops (Pinned) */}
          <div className="rounded-2xl border border-blue-500/25 bg-gray-950 p-4">
            <div className="flex items-center justify-between mb-3">
              <h2 className="text-blue-300 flex items-center gap-2">
                <Sparkles className="w-4 h-4" /> Pinned Offer Drops
              </h2>
              <div className="text-[10px] text-gray-400">Limited + timed</div>
            </div>

            <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
              {OFFER_DROPS.map((d) => {
                const ends = dropEnds[d.id] ?? 0;
                const slots = dropSlots[d.id] ?? 0;
                const disabled = ends <= 0 || slots <= 0;
                return (
                  <div key={d.id} className="rounded-xl border border-blue-500/25 bg-black/40 p-3">
                    <div className="flex items-start justify-between gap-2">
                      <div>
                        <div className="text-sm text-blue-200 font-medium">{d.title}</div>
                        <div className="text-[11px] text-gray-400 mt-1">{d.description}</div>
                      </div>
                      <div className="text-[10px] text-gray-300 whitespace-nowrap">{formatMMSS(ends)}</div>
                    </div>

                    <div className="flex items-center justify-between mt-3">
                      <div className="text-[11px] text-gray-300">
                        Slots: {slots}/{d.totalSlots}
                      </div>
                      <button
                        onClick={() => claimDrop(d)}
                        disabled={disabled}
                        className={`px-3 py-1.5 rounded-lg text-xs border ${
                          disabled
                            ? "border-gray-700 text-gray-500"
                            : "border-blue-400/50 text-blue-200 hover:bg-blue-600/10"
                        }`}
                      >
                        Unlock ${d.price}
                      </button>
                    </div>
                  </div>
                );
              })}
            </div>
          </div>

          {/* Creator Secrets */}
          <div className="rounded-2xl border border-pink-500/30 bg-gray-950 p-4">
            <h2 className="text-pink-300 mb-3 flex items-center gap-2">
              <Flame className="w-4 h-4" /> Creator Secrets
              <span className="text-[10px] text-gray-400">Blurred until unlocked</span>
            </h2>

            <div className="space-y-2">
              {CREATOR_SECRETS.map((s) => {
                const isRevealed = !!revealedSecrets[s.id];
                return (
                  <div
                    key={s.id}
                    className="flex items-center justify-between border border-pink-500/20 rounded-xl p-3 bg-black/30"
                  >
                    <div className="min-w-0">
                      <div className="text-sm text-pink-200">{s.title}</div>
                      <div className={`text-[11px] mt-1 ${isRevealed ? "text-gray-200" : "text-gray-500"}`}>
                        {isRevealed ? s.reveal : "‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà"}
                      </div>
                    </div>
                    <button
                      onClick={() => revealSecret(s)}
                      disabled={isRevealed}
                      className={`ml-3 px-3 py-1.5 rounded-lg text-xs border ${
                        isRevealed
                          ? "border-gray-700 text-gray-500"
                          : "border-pink-400/50 text-pink-200 hover:bg-pink-600/10"
                      }`}
                    >
                      {isRevealed ? "Unlocked" : `Unlock $${s.price}`}
                    </button>
                  </div>
                );
              })}
            </div>
          </div>

          {/* Favorites */}
          <div className="rounded-2xl border border-pink-500/30 bg-gray-950 p-4">
            <h2 className="text-pink-300 mb-3 flex items-center gap-2">
              <Gift className="w-4 h-4" /> Creator Favorites
              <span className="text-[10px] text-gray-400">Reveal links, then Buy sends funds</span>
            </h2>

            <div className="grid grid-cols-3 gap-2 mb-3">
              {(Object.keys(FAVORITES) as FavTier[]).map((t) => (
                <button
                  key={t}
                  onClick={() => unlockFavoritesTier(t)}
                  className={`rounded-lg border py-2 text-xs hover:bg-pink-600/10 ${
                    unlocked[t] ? "border-pink-500" : "border-pink-500/30"
                  }`}
                >
                  {unlocked[t] ? `Unlocked ${t}` : `Unlock ${t} ($${FAVORITES[t].unlock})`}
                </button>
              ))}
            </div>

            {!activeTier ? (
              <div className="text-[11px] text-gray-500">Select a tier to view items.</div>
            ) : (
              <div className="space-y-2">
                {FAVORITES[activeTier].items.map((it) => {
                  const key = `${activeTier}:${it.name}`;
                  const linkRevealed = !!revealedLinks[key];
                  return (
                    <div key={it.name} className="border border-pink-500/20 rounded-xl p-3 bg-black/30">
                      <div className="flex items-start justify-between gap-3">
                        <div className="min-w-0">
                          <div className="text-sm text-gray-100">{it.name}</div>
                          <div className="text-[11px] mt-1 text-gray-400">
                            {it.linkLabel}:{" "}
                            {linkRevealed ? (
                              <a
                                className="text-blue-300 underline"
                                href={it.linkUrl}
                                target="_blank"
                                rel="noreferrer"
                              >
                                {it.linkUrl}
                              </a>
                            ) : (
                              <span className="text-gray-500">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span>
                            )}
                          </div>
                        </div>
                        <div className="flex flex-col gap-2 items-end">
                          <button
                            onClick={() => revealFavoriteLink(activeTier, it.name, it.revealFee)}
                            disabled={linkRevealed}
                            className={`px-3 py-1.5 rounded-lg text-xs border ${
                              linkRevealed
                                ? "border-gray-700 text-gray-500"
                                : "border-blue-400/40 text-blue-200 hover:bg-blue-600/10"
                            }`}
                          >
                            {linkRevealed ? "Link revealed" : `Reveal $${it.revealFee}`}
                          </button>
                          <button
                            onClick={() => buyForHer(it.price, it.name)}
                            className="px-3 py-1.5 rounded-lg text-xs bg-pink-600 hover:bg-pink-700"
                          >
                            Buy ${it.price}
                          </button>
                        </div>
                      </div>
                    </div>
                  );
                })}

                <div className="text-[10px] text-gray-400">
                  Buy-for-her sends the amount to the creator as a tip (fan assumes item is purchased).
                </div>
              </div>
            )}
          </div>
        </div>

        {/* MIDDLE: Chat */}
        <aside className="rounded-2xl border border-pink-500/30 bg-gray-950 p-4 flex flex-col">
          <h3 className="text-pink-300 mb-2 flex items-center gap-1">
            <MessageCircle className="w-4 h-4" /> Live Chat
          </h3>
          <div className="flex-1 overflow-y-auto text-xs space-y-1 mb-2">
            {chat.map((m, i) => (
              <div key={`${i}-${m.slice(0, 10)}`}>{m}</div>
            ))}
          </div>
          <div className="flex gap-2">
            <input
              value={chatInput}
              onChange={(e) => setChatInput(e.target.value)}
              className="flex-1 bg-black border border-pink-500/30 rounded-lg px-2 py-1 text-xs"
              placeholder="Say something sweet‚Ä¶"
            />
            <button
              onClick={sendMessage}
              className="bg-pink-600 px-3 rounded-lg text-xs hover:bg-pink-700"
            >
              Send
            </button>
          </div>
        </aside>

        {/* RIGHT: Monetization */}
        <aside className="rounded-2xl border border-pink-500/30 bg-gray-950 p-4 space-y-4">
          {/* Pay-to-stay control (action-only) */}
          {payToStayNeeded && (
            <div className="rounded-xl border border-pink-500/25 bg-black/40 p-3">
              <div className="flex items-center justify-between">
                <div className="text-sm text-pink-200 flex items-center gap-2">
                  <Timer className="w-4 h-4" /> Time Expired
                </div>
                <div className="text-[10px] text-gray-400">Add time to stay</div>
              </div>
              <button
                onClick={payToStayOneMinute}
                className="mt-3 w-full bg-pink-600 py-2 rounded-xl hover:bg-pink-700 text-sm"
              >
                Pay to Stay +1 min
              </button>
            </div>
          )}

          {/* Paid Request Menu */}
          <div className="rounded-xl border border-blue-500/20 bg-black/40 p-3">
            <div className="flex items-center justify-between">
              <div className="text-blue-200 text-sm flex items-center gap-2">
                <Mic className="w-4 h-4" /> Request Menu
              </div>
              <div className="text-[10px] text-gray-400">Paid requests</div>
            </div>

            <textarea
              value={requestText}
              onChange={(e) => setRequestText(e.target.value)}
              className="mt-2 w-full bg-black border border-blue-500/20 rounded-lg px-2 py-2 text-xs"
              rows={3}
              placeholder="Write what you want her to do‚Ä¶"
            />

            <div className="mt-2 grid grid-cols-2 gap-2">
              {PAID_REQUESTS.map((r) => (
                <button
                  key={r.id}
                  onClick={() => submitRequest(r)}
                  title={r.hint}
                  className="border border-blue-400/30 rounded-xl py-2 hover:bg-blue-600/10 text-xs text-blue-200"
                >
                  {r.label} ¬∑ ${r.price}
                </button>
              ))}
            </div>
          </div>

          {/* Send Suga */}
          <div>
            <h3 className="text-pink-300">Send Suga</h3>
            <div className="grid grid-cols-2 gap-2 mt-2">
              {GIFTS.map((g) => (
                <button
                  key={g.label}
                  onClick={() => sendGift(g.label, g.amount)}
                  className="border border-pink-500/30 rounded-xl py-2 hover:bg-pink-600/10"
                >
                  {g.label} ¬∑ ${g.amount}
                </button>
              ))}
            </div>
          </div>

          {/* Quick paid actions */}
          <button className="w-full bg-pink-600 py-2 rounded-xl hover:bg-pink-700">
            Say My Name ($15)
          </button>
          <button className="w-full border border-pink-500/40 py-2 rounded-xl hover:bg-pink-600/10">
            Sponsor Room ($100)
          </button>

          <div className="grid grid-cols-2 gap-2">
            <button className="border border-pink-500/40 py-2 rounded-xl text-xs flex items-center justify-center gap-1 hover:bg-pink-600/10">
              <Mic className="w-4 h-4" /> Voice $10
            </button>
            <button className="border border-pink-500/40 py-2 rounded-xl text-xs flex items-center justify-center gap-1 hover:bg-pink-600/10">
              <ImageIcon className="w-4 h-4" /> Photo $15
            </button>
          </div>

          <button className="w-full bg-pink-600 py-2 rounded-xl flex items-center justify-center gap-2 hover:bg-pink-700">
            <Lock className="w-4 h-4" /> Private 1-on-1 ($10/min)
          </button>

          <div className="text-xs text-gray-400">
            <p className="flex items-center gap-1">
              <Star className="w-3 h-3" /> Spending triggers reactions and visibility
            </p>
            <p className="flex items-center gap-1">
              <Heart className="w-3 h-3" /> Buy-for-her sends funds to creator
            </p>
          </div>
        </aside>
      </main>

      {/* Bottom subtle timer bar (experience-first; no pricing) */}
      <div className="max-w-7xl mx-auto px-8 pb-10">
        <div className="rounded-2xl border border-pink-500/15 bg-gray-950/60 p-3 text-[11px] text-gray-400 flex items-center justify-between">
          <span className="inline-flex items-center gap-2">
            <Timer className="w-4 h-4 text-pink-300" /> Session time: {formatMMSS(secondsInRoom)}
          </span>
          <span className="inline-flex items-center gap-2">
            {freeRemaining > 0 ? (
              <>
                <span className="text-pink-200">Free time remaining</span>
                <span className="text-gray-200">{formatMMSS(freeRemaining)}</span>
              </>
            ) : (
              <>
                <span className="text-pink-200">Paid time remaining</span>
                <span className="text-gray-200">{formatMMSS(Math.max(0, paidSecondsRemaining))}</span>
              </>
            )}
          </span>
        </div>
      </div>
    </div>
  );
}






Below is a backend API contract you can hand to a developer to implement Suga4U Room exactly as the current React mockup behaves.

I‚Äôm assuming:

REST + WebSockets (or SSE) for room realtime

JWT auth

Stripe (or equivalent) for card payments + an internal Wallet ledger

All money actions go through a single Payments/Transactions layer with idempotency keys

You can adapt naming to your stack (NestJS/Express/FastAPI/Rails, etc.).

Backend API Contract ‚Äî Suga4U Room (v1)
Global rules (Suga4U)

Entry fee: $10 unless VIP tier ‚Üí free entry

Time: first 10 minutes free, then $2 per minute

Pay-to-stay is purchased in 1-minute blocks

No ‚Äúbadge pricing/rules education‚Äù endpoints needed inside this room (that‚Äôs Signup/Profile)

1) Authentication
POST /v1/auth/login

Returns JWT access token + refresh.

POST /v1/auth/refresh

Returns new access token.

All endpoints below require:
Authorization: Bearer <token>

2) Core entities (data model)
Users

users

id

role: fan | creator | admin

display_name

created_at

Creator Profile

creator_profiles

creator_id

gender: male | female (used to tint ‚ÄúSuga Baby‚Äù label)

avatar_url

cover_url

created_at

Fan Badge / Tier (Suga Daddy/Mama tiers)

fan_suga_tiers

fan_id

tier: Bronze | Silver | Gold | Platinum | VIP

active: boolean

renews_at

created_at

Room

rooms

id

type: SUGA4U

creator_id

status: live | offline

created_at

Room Session (authoritative timing)

room_sessions

id

room_id

fan_id

creator_id

started_at

entry_paid: boolean

free_seconds_total: default 600

paid_seconds_purchased: integer

paid_seconds_used: integer

ended_at nullable

last_heartbeat_at

state: active | expired | ended

Derived values:

free_seconds_remaining = max(0, free_total - elapsed)

paid_seconds_remaining = max(0, paid_purchased - paid_used)

‚ÄúExpired‚Äù means: free window is done AND paid remaining is 0

Ledger / Transactions (single source of truth)

transactions

id

type:

ENTRY_FEE

PAY_TO_STAY

TIP

SECRET_UNLOCK

OFFER_CLAIM

PAID_REQUEST

FAVORITES_TIER_UNLOCK (optional)

LINK_REVEAL

BUY_FOR_HER

fan_id

creator_id

room_id nullable

session_id nullable

amount_cents

currency (e.g., USD)

platform_fee_cents

creator_earnings_cents

status: pending | confirmed | failed | refunded

idempotency_key

metadata JSON

created_at

Secrets

creator_secrets

id

creator_id

title

price_cents

reveal_payload (string/JSON)

active

secret_unlocks

id

fan_id

creator_id

secret_id

transaction_id

unlocked_at

Offer Drops

offer_drops

id

creator_id

title

description

price_cents

total_slots

ends_at

active

offer_claims

id

fan_id

creator_id

offer_id

transaction_id

created_at

Critical: enforce slots with a DB lock/transaction to prevent overselling.

Favorites (tiers + items)

favorite_tiers

id

creator_id

tier_key: cute | luxury | dream

unlock_price_cents (optional if you persist tier unlock)

active

favorite_items

id

creator_id

tier_key

name

item_price_cents (used for Buy-for-her)

link_label

link_url

reveal_fee_cents

active

favorite_tier_unlocks (optional)

fan_id

creator_id

tier_key

transaction_id

unlocked_at

link_reveals

fan_id

creator_id

item_id

transaction_id

revealed_at

Paid Requests (creator fulfillment queue)

paid_requests

id

fan_id

creator_id

room_id nullable

session_id nullable

type: POSE | SHOUTOUT | QUICK_TEASE | CUSTOM_CLIP

note

price_cents

status: pending | accepted | fulfilled | declined | refunded

transaction_id

created_at

3) Idempotency + error standards
Idempotency

For every paid action endpoint, require:

Idempotency-Key: <uuid>

Store it on the transactions.idempotency_key.
If the same key repeats, return the original transaction result.

Error format
{
  "error": {
    "code": "ROOM_EXPIRED",
    "message": "Paid time is required to continue.",
    "details": { }
  }
}


Common codes:

UNAUTHORIZED

FORBIDDEN

NOT_FOUND

VALIDATION_ERROR

PAYMENT_FAILED

ROOM_ENTRY_REQUIRED

ROOM_EXPIRED

OFFER_SOLD_OUT

OFFER_EXPIRED

ALREADY_UNLOCKED

4) Suga4U Room endpoints
4.1 Get room + monetization surfaces

GET /v1/rooms/{roomId}/suga4u

Response

{
  "room": {
    "id": "room_123",
    "type": "SUGA4U",
    "creator_id": "cr_1",
    "status": "live"
  },
  "creator": {
    "id": "cr_1",
    "display_name": "CreatorName",
    "gender": "female",
    "avatar_url": "...",
    "spotlight_stream": { "provider": "webrtc", "join_token": "..." }
  },
  "fan": {
    "id": "fan_9",
    "tier": "Gold",
    "is_vip": false
  },
  "config": {
    "entry_fee_cents": 1000,
    "free_seconds": 600,
    "pay_to_stay_per_minute_cents": 200
  },
  "surfaces": {
    "gifts": [
      { "label": "üíñ Kiss", "amount_cents": 500 },
      { "label": "üî• Tease", "amount_cents": 1000 }
    ],
    "paid_requests": [
      { "type": "POSE", "label": "Pose Request", "price_cents": 1000 }
    ]
  }
}

4.2 Create/join a session (server-authoritative)

POST /v1/rooms/{roomId}/sessions

Body

{ "client_context": { "device": "web" } }


Response

{
  "session": {
    "id": "sess_abc",
    "room_id": "room_123",
    "fan_id": "fan_9",
    "entry_required": true,
    "entry_paid": false,
    "free_seconds_total": 600,
    "free_seconds_remaining": 600,
    "paid_seconds_remaining": 0,
    "state": "active"
  }
}


Rules

If VIP ‚Üí entry_required=false and entry_paid=true immediately.

For non-VIP ‚Üí entry_required=true and entry_paid=false until payment.

4.3 Heartbeat (keeps session alive + updates time usage)

POST /v1/rooms/{roomId}/sessions/{sessionId}/heartbeat

Body

{ "client_ts": 1730000000 }


Response

{
  "session_state": {
    "free_seconds_remaining": 412,
    "paid_seconds_remaining": 0,
    "state": "active",
    "expired": false
  }
}


If expired:

{
  "session_state": {
    "free_seconds_remaining": 0,
    "paid_seconds_remaining": 0,
    "state": "expired",
    "expired": true
  }
}

4.4 Pay entry fee ($10) ‚Äî non-VIP only

POST /v1/rooms/{roomId}/sessions/{sessionId}/entry

Headers:

Idempotency-Key: <uuid>

Body

{ "payment_method": "wallet|card", "payment_method_id": "pm_..." }


Response

{
  "transaction": { "id": "txn_1", "status": "confirmed", "amount_cents": 1000 },
  "session": { "entry_paid": true }
}


Error if VIP (optional):

VALIDATION_ERROR: entry_not_required

4.5 Pay-to-stay (+1 minute at $2)

POST /v1/rooms/{roomId}/sessions/{sessionId}/pay-to-stay

Headers:

Idempotency-Key

Body

{ "minutes": 1, "payment_method": "wallet|card", "payment_method_id": "pm_..." }


Response

{
  "transaction": { "id": "txn_2", "status": "confirmed", "amount_cents": 200 },
  "session_state": { "paid_seconds_remaining": 60, "state": "active" }
}


Rules

Must have entry_paid=true OR VIP.

If session is ended, return FORBIDDEN.

5) Secrets endpoints
5.1 List secrets + unlock states (blurred)

GET /v1/creators/{creatorId}/secrets?room_id=room_123

Response

{
  "secrets": [
    {
      "id": "sec_1",
      "title": "My real type‚Ä¶",
      "price_cents": 800,
      "unlocked": false,
      "reveal_payload": null
    }
  ]
}

5.2 Unlock secret

POST /v1/creators/{creatorId}/secrets/{secretId}/unlock

Headers:

Idempotency-Key

Body:

{ "room_id": "room_123", "session_id": "sess_abc", "payment_method": "wallet|card", "payment_method_id": "pm_..." }


Response:

{
  "transaction": { "id": "txn_3", "status": "confirmed", "amount_cents": 800 },
  "secret": { "id": "sec_1", "unlocked": true, "reveal_payload": "..." }
}


If already unlocked:

return 200 with unlocked=true and existing reveal payload.

6) Offer Drops endpoints
6.1 List drops

GET /v1/creators/{creatorId}/offer-drops?room_id=room_123

Response:

{
  "offers": [
    {
      "id": "off_1",
      "title": "Limited Voice Note Drop",
      "description": "...",
      "price_cents": 1500,
      "ends_at": "2026-01-01T00:00:00Z",
      "slots_remaining": 7,
      "total_slots": 10
    }
  ]
}

6.2 Claim an offer (atomic slots)

POST /v1/creators/{creatorId}/offer-drops/{offerId}/claim

Headers:

Idempotency-Key

Body:

{ "room_id": "room_123", "session_id": "sess_abc", "payment_method": "wallet|card", "payment_method_id": "pm_..." }


Response:

{
  "transaction": { "id": "txn_4", "status": "confirmed", "amount_cents": 1500 },
  "offer": { "id": "off_1", "slots_remaining": 6 }
}


Errors:

OFFER_SOLD_OUT

OFFER_EXPIRED

7) Favorites endpoints (tier unlock + link reveal + buy-for-her)
7.1 Get favorites tiers/items with reveal state

GET /v1/creators/{creatorId}/favorites?room_id=room_123

Response:

{
  "tiers": [
    { "tier_key": "cute", "unlock_price_cents": 1000, "unlocked": false }
  ],
  "items": [
    {
      "id": "fav_1",
      "tier_key": "cute",
      "name": "Cute Top",
      "item_price_cents": 4000,
      "link_label": "Store link",
      "reveal_fee_cents": 300,
      "link_revealed": false,
      "link_url": null
    }
  ]
}

7.2 Unlock tier (optional if you persist)

POST /v1/creators/{creatorId}/favorites/tiers/{tierKey}/unlock

Headers:

Idempotency-Key

Body:

{ "room_id": "room_123", "session_id": "sess_abc", "payment_method": "wallet|card", "payment_method_id": "pm_..." }


Response:

{
  "transaction": { "id": "txn_5", "status": "confirmed", "amount_cents": 1000 },
  "tier": { "tier_key": "cute", "unlocked": true }
}

7.3 Reveal link (micro fee)

POST /v1/creators/{creatorId}/favorites/items/{itemId}/reveal

Headers:

Idempotency-Key

Body:

{ "room_id": "room_123", "session_id": "sess_abc", "payment_method": "wallet|card", "payment_method_id": "pm_..." }


Response:

{
  "transaction": { "id": "txn_6", "status": "confirmed", "amount_cents": 300 },
  "item": { "id": "fav_1", "link_revealed": true, "link_url": "https://..." }
}

7.4 Buy-for-her (tip equals item price)

POST /v1/creators/{creatorId}/favorites/items/{itemId}/buy

Headers:

Idempotency-Key

Body:

{ "room_id": "room_123", "session_id": "sess_abc", "payment_method": "wallet|card", "payment_method_id": "pm_..." }


Response:

{
  "transaction": {
    "id": "txn_7",
    "type": "BUY_FOR_HER",
    "status": "confirmed",
    "amount_cents": 4000,
    "metadata": { "item_id": "fav_1", "item_name": "Cute Top" }
  }
}


Important: this should not trigger external store checkout. It‚Äôs a creator payout flow.

8) Paid Requests endpoints
8.1 Create paid request ticket

POST /v1/creators/{creatorId}/paid-requests

Headers:

Idempotency-Key

Body:

{
  "room_id": "room_123",
  "session_id": "sess_abc",
  "type": "POSE",
  "note": "Turn around slowly, tease",
  "payment_method": "wallet|card",
  "payment_method_id": "pm_..."
}


Response:

{
  "transaction": { "id": "txn_8", "status": "confirmed", "amount_cents": 1000 },
  "request": { "id": "req_1", "status": "pending" }
}

8.2 Creator fetch request queue

GET /v1/creator/me/paid-requests?status=pending&limit=50

8.3 Creator update request

PATCH /v1/creator/me/paid-requests/{requestId}

Body:

{ "status": "accepted" }


(Optionally allow declined with automatic refund policy.)

9) Tips / Gifts endpoints
9.1 Tip (including Gift buttons)

POST /v1/creators/{creatorId}/tips

Headers:

Idempotency-Key

Body:

{
  "room_id": "room_123",
  "session_id": "sess_abc",
  "amount_cents": 1000,
  "label": "üî• Tease",
  "payment_method": "wallet|card",
  "payment_method_id": "pm_..."
}


Response:

{ "transaction": { "id": "txn_9", "status": "confirmed" } }

10) Chat + Realtime

You can implement with WebSockets (recommended).

10.1 Connect

WS /v1/ws?room_id=room_123&session_id=sess_abc

Server should validate:

JWT

session belongs to user

entry paid (or VIP) before allowing chat if you want strict enforcement

10.2 Events (examples)

Client ‚Üí Server

chat.send

presence.heartbeat

Server ‚Üí Client

chat.message

session.state (free/paid remaining)

offer.updated (slots change)

tip.reaction (emoji overlay trigger)

11) Payments layer contract (internal)
Payment intent (if using card)

POST /v1/payments/intents

Creates Stripe PaymentIntent and returns client secret

Confirmed webhook

POST /v1/webhooks/stripe

Updates transactions.status to confirmed/failed

If confirmed:

apply entitlements (unlock secret/link/tier)

increment paid time (if pay-to-stay)

decrement offer slots (if offer claim; usually do slot lock before capturing)

Developer note: For limited slots, safest approach is:

reserve slot in DB transaction

create payment intent

if payment fails, release reservation on timeout

12) Moderation / Compliance hooks (minimal)

Even if you do not ‚Äúauto-approve,‚Äù you still need:

POST /v1/moderation/report (user reports content)

POST /v1/moderation/block (block user)

POST /v1/moderation/mute (mute user in room)

Implementation notes (developer guidance)

Room timing must be server-authoritative (client timer is only UI).

All paid endpoints must be idempotent.

Entitlements must be persisted (secret unlocks, link reveals, etc.).

For performance: prefetch room surfaces with the GET /suga4u call, and lazy-load heavy lists if needed.

For security: disallow link URLs from being returned until link_reveal entitlement exists.